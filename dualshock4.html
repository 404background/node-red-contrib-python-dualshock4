<script type="text/javascript">
    RED.nodes.registerType('dualshock4', {
      category: 'python',
      color: '#4d4ddd',
      defaults: {
        name: { value: "" },
        sleep: { value: 50, validate: RED.validators.number() },
        selectedInputs: { value: [] }
      },
      inputs: 1,
      outputs: 1,
      icon: "joystick.png",
      label: function () {
        return this.name || "DualShock4";
      },
      oneditprepare: function() {
        var node = this;
        var inputs = node.selectedInputs || [];
  
        $("#node-input-selectedInputs input").each(function() {
          $(this).prop("checked", inputs.includes($(this).val()));
        });
      },
      oneditsave: function() {
        var inputs = [];
        $("#node-input-selectedInputs input:checked").each(function() {
          inputs.push($(this).val());
        });
        $("#node-input-selectedInputs").val(inputs);
        this.selectedInputs = inputs;
      }
    });
  </script>
  
  <script type="text/html" data-template-name="dualshock4">
    <div class="form-row">
      <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
      <input type="text" id="node-input-name" placeholder="DualShock4">
    </div>
    <div class="form-row">
      <label for="node-input-sleep"><i class="fa fa-clock-o"></i> Sleep (ms)</label>
      <input type="number" id="node-input-sleep" placeholder="50">
    </div>
    <div class="form-row">
      <label><i class="fa fa-gamepad"></i> Select Inputs</label><br>
      <div id="node-input-selectedInputs">
        <strong>Axes:</strong><br>
        <input type="checkbox" value="axis_0"> Left Stick X<br>
        <input type="checkbox" value="axis_1"> Left Stick Y<br>
        <input type="checkbox" value="axis_2"> Right Stick X<br>
        <input type="checkbox" value="axis_3"> Right Stick Y<br>
        <input type="checkbox" value="axis_4"> L2 Trigger<br>
        <input type="checkbox" value="axis_5"> R2 Trigger<br>
        <br>
        <strong>Buttons:</strong><br>
        <input type="checkbox" value="button_0"> Cross (X)<br>
        <input type="checkbox" value="button_1"> Circle (O)<br>
        <input type="checkbox" value="button_2"> Square (□)<br>
        <input type="checkbox" value="button_3"> Triangle (△)<br>
        <input type="checkbox" value="button_4"> L1<br>
        <input type="checkbox" value="button_5"> R1<br>
        <input type="checkbox" value="button_6"> L2<br>
        <input type="checkbox" value="button_7"> R2<br>
        <input type="checkbox" value="button_8"> Share<br>
        <input type="checkbox" value="button_9"> Options<br>
        <input type="checkbox" value="button_10"> L3<br>
        <input type="checkbox" value="button_11"> R3<br>
        <input type="checkbox" value="button_12"> PS Button<br>
        <input type="checkbox" value="button_13"> Touchpad Click<br>
      </div>
    </div>
  </script>
  